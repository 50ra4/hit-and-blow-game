# T-004: 国際化（i18n）セットアップ

## 目的

react-i18next / i18next を用いた多言語対応の基盤を構築する。日本語・英語の翻訳ファイルを作成する。

## 背景

- `docs/02_architecture.md` セクション7「国際化（i18n）設計」
- `docs/03_database.md` セクション5.3「エラーメッセージ（i18n）」
- `docs/04_api.md` セクション8.3「エラーメッセージ（i18n）」

## 実装内容

### 追加ファイル

| ファイル | 内容 |
|---------|------|
| `src/i18n/index.ts` | i18next初期化設定 |
| `src/i18n/locales/ja.json` | 日本語翻訳ファイル |
| `src/i18n/locales/en.json` | 英語翻訳ファイル |

### 変更ファイル

なし

### 実装詳細

#### i18n/index.ts

`docs/02_architecture.md` セクション7.1 のコードを実装する。

```typescript
import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';
import { LANGUAGE_IDS } from '@/consts/languages';
import ja from './locales/ja.json';
import en from './locales/en.json';

i18n
  .use(initReactI18next)
  .init({
    resources: {
      [LANGUAGE_IDS.JA]: { translation: ja },
      [LANGUAGE_IDS.EN]: { translation: en }
    },
    lng: LANGUAGE_IDS.JA,
    fallbackLng: LANGUAGE_IDS.JA,
    interpolation: { escapeValue: false }
  });

export default i18n;
```

#### locales/ja.json

`docs/02_architecture.md` セクション7.2 の日本語翻訳 + `docs/03_database.md` セクション5.3 のエラーメッセージ + `docs/04_api.md` セクション8.3 のエラーメッセージを統合する。

**キー構造:**

```
common.*          — 共通テキスト（title, start, restart, back）
mode.*            — モード名（beginner〜master, locked）
game.*            — ゲーム中テキスト（submit, attempts, hit, blow）
result.*          — 結果テキスト（win, lose, attempts, share, restart）
stats.*           — 統計テキスト（title, totalPlays, winRate, avgAttempts, bestAttempts, clear）
error.storage.*   — ストレージエラー（title, message, description, clearAndReload）
error.network.*   — ネットワークエラー（offline, shareUnavailable）
error.share.*     — シェアエラー（failed, imageGenerationFailed）
error.liff.*      — Liffエラー（initFailed）
```

#### locales/en.json

上記の英語版。`docs/02_architecture.md` セクション7.2 の英語翻訳 + エラーメッセージ英語版を統合する。

## 入出力仕様

- Input: `@/consts/languages.ts` の `LANGUAGE_IDS`
- Output: `i18n` インスタンス（`useTranslation()` フックで使用可能）

## 受け入れ条件（Definition of Done）

- [ ] `src/i18n/index.ts` が作成され、i18nextが初期化される
- [ ] `src/i18n/locales/ja.json` に全テキストが含まれている
- [ ] `src/i18n/locales/en.json` に全テキストが含まれている
- [ ] `useTranslation()` で `t('common.title')` が「タイルヒットアンドブロー」を返す
- [ ] `mode.locked` がinterpolation変数 `{{condition}}` を含む
- [ ] エラーメッセージ（storage, network, share, liff）が含まれている
- [ ] `pnpm type-check` でエラーがないこと

## テスト観点

- 正常系: デフォルト言語（ja）でテキストが正しく取得できること
- 正常系: 言語切替（en）でテキストが正しく切り替わること
- 正常系: interpolation変数が正しく置換されること（例: `t('mode.locked', { condition: 'ノーマル' })`）
- 正常系: 存在しないキーでfallbackLng（ja）のテキストが返ること

## 依存タスク

- T-002（定数定義 — `LANGUAGE_IDS` を使用）

## 要確認事項

- ~~通知設定の翻訳キー~~ → **確定: 追加しない。設定モーダルはテーマ・効果音のみ。**
- ~~チュートリアル翻訳テキスト~~ → **確定: T-017実装時に ja.json / en.json に追加する（T-004の初期ファイルにはスタブを含めなくてよい）**
- ~~利用規約・プライバシーポリシー本文~~ → **確定: T-018で内容確定済み。T-004では翻訳キー（ページタイトル等）のみを追加する。**
